<!DOCTYPE html>
<html>
    <title>World Editor</title>
    <link rel="stylesheet" href="style.css"/>
    <body>
        <h1>World Editor</h1>
        <canvas id="myCanvas"></canvas>
        <div id="controls">
            <button onclick="addRandomPoint()">Add Point</button>
            <button onclick="removeRandomPoint()">Remove Point</button>
            <button onclick="addRandomSegments()">Add Segments</button>
            <button onclick="removeRandomSegments()">Remove Segments</button>
            <button onclick="removeAll()">clear</button>
        </div>
        <script src="js/math/graphEditor.js"></script>
        <script src="js/math/graph.js"></script>
        <script src="js/math/utils.js"></script>
        <script src="js/primitives/point.js"></script>
        <script src="js/primitives/segment.js"></script>
        <script>
            function removeAll()
            {
                graph.clear();
                ctx.clearRect(0,0,myCanvas.width,myCanvas.height);
                graph.draw(ctx);
            }
            function removeRandomSegments(){
                if(graph.segments.length==0)
                {
                    console.log("No seg");
                }
                const index=Math.floor(Math.random()*graph.segments.length);
                graph.removeSegment(graph.segments[index]);
                ctx.clearRect(0,0,myCanvas.width,myCanvas.height);
                graph.draw(ctx);
            }
            function addRandomSegments(){
                const index1=Math.floor(Math.random()*graph.points.length);
                const index2=Math.floor(Math.random()*graph.points.length);
                const success=graph.tryAddSegment(
                    new Segment(graph.points[index1],graph.points[index2])
                    )
                // if(index1!=index2)
                // {
                // }
                ctx.clearRect(0,0,myCanvas.width,myCanvas.height);
                graph.draw(ctx);
                console.log(success);
            }
            function removeRandomPoint(){
                if(graph.points.length==0)
                {
                    console.log("No Points");
                }
                const index=Math.floor(Math.random()*graph.points.length);
                graph.removePoint(graph.points[index]);
                ctx.clearRect(0,0,myCanvas.width,myCanvas.height);
                graph.draw(ctx);
            }
            function addRandomPoint()
            {
                graph.tryAddPoint(
                    new Point(
                        Math.random()*myCanvas.width,
                        Math.random()*myCanvas.height
                    )
                );
                ctx.clearRect(0,0,myCanvas.width,myCanvas.height);
                graph.draw(ctx);
            }
            myCanvas.width=600;
            myCanvas.height=600;
            const ctx=myCanvas.getContext("2d");
           const p1=new Point(200,200); 
           const p2=new Point(500,200); 
           const p3=new Point(400,400); 
           const p4=new Point(100,300); 
            
           const s1=new Segment(p1,p2);
           const s2=new Segment(p1,p3);
           const s3=new Segment(p1,p4);
            const s4=new Segment(p2,p3);
            const graph=new Graph([p1,p2,p3,p4],[s1,s2,s3,s4]);
            const graphEditor=new GraphEditor(myCanvas,graph);
            // graph.draw(ctx);
            animate();

            function animate()
            {
                ctx.clearRect(0,0,myCanvas.width,myCanvas.height);
                graphEditor.display();
                requestAnimationFrame(animate);
            }
        </script>
    </body>
</html>